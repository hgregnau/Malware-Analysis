import olevba

# Example script to scan a file using olevba
file_path = 'path_to_malware_file.doc'

# Scan the file
vba_parser = olevba.VBA_Parser(file_path)
if vba_parser.detect_vba_macros():
    for (filename, stream_path, vba_filename, vba_code) in vba_parser.extract_macros():
        print(f"Filename: {filename}")
        print(f"Stream Path: {stream_path}")
        print(f"VBA Filename: {vba_filename}")
        print(f"VBA Code: {vba_code}")
else:
    print("No VBA macros found.")
